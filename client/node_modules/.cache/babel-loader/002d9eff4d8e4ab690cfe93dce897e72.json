{"ast":null,"code":"import _toConsumableArray from\"C:/Users/scs/OneDrive/Desktop/9 hours insa_allah/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _regeneratorRuntime from\"C:/Users/scs/OneDrive/Desktop/9 hours insa_allah/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/scs/OneDrive/Desktop/9 hours insa_allah/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/scs/OneDrive/Desktop/9 hours insa_allah/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useContext,useState,useEffect}from\"react\";import{GlobalState}from\"../../../GlobaalState\";import axios from\"axios\";import PaypalButton from\"./PaypalButton\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Cart(){var state=useContext(GlobalState);var _state$userAPI$cart=_slicedToArray(state.userAPI.cart,2),cart=_state$userAPI$cart[0],setCart=_state$userAPI$cart[1];var _state$token=_slicedToArray(state.token,1),token=_state$token[0];var _useState=useState(0),_useState2=_slicedToArray(_useState,2),total=_useState2[0],setTotal=_useState2[1];useEffect(function(){var getTotal=function getTotal(){var total=cart.reduce(function(prev,item){return prev+item.price*item.quantity;},0);setTotal(total);};getTotal();},[cart]);var addToCart=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(cart){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.patch(\"/user/addcart\",{cart:cart},{headers:{Authorization:token}});case 2:case\"end\":return _context.stop();}}},_callee);}));return function addToCart(_x){return _ref.apply(this,arguments);};}();var increment=function increment(id){cart.forEach(function(item){if(item._id===id){item.quantity+=1;}});setCart(_toConsumableArray(cart));addToCart(cart);};var decrement=function decrement(id){cart.forEach(function(item){if(item._id===id){item.quantity===1?item.quantity=1:item.quantity-=1;}});setCart(_toConsumableArray(cart));addToCart(cart);};var removeProduct=function removeProduct(id){if(window.confirm(\"Do you want to delete this product?\")){cart.forEach(function(item,index){if(item._id===id){cart.splice(index,1);}});setCart(_toConsumableArray(cart));addToCart(cart);}};var tranSuccess=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(payment){var paymentID,address;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:paymentID=payment.paymentID,address=payment.address;console.log(payment);_context2.next=4;return axios.post(\"/api/payment\",{cart:cart,paymentID:paymentID,address:address},{headers:{Authorization:token}});case 4:setCart([]);addToCart([]);alert(\"You have successfully placed an order.\");case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function tranSuccess(_x2){return _ref2.apply(this,arguments);};}();if(cart.length===0)return/*#__PURE__*/_jsx(\"h2\",{style:{textAlign:\"center\",fontSize:\"5rem\"},children:\"Cart Empty\"});return/*#__PURE__*/_jsxs(\"div\",{children:[cart.map(function(product){return/*#__PURE__*/_jsxs(\"div\",{className:\"detail cart\",children:[/*#__PURE__*/_jsx(\"img\",{src:product.images.url,alt:\"\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"box-detail\",children:[/*#__PURE__*/_jsx(\"h2\",{children:product.title}),/*#__PURE__*/_jsxs(\"h3\",{children:[\"$ \",product.price*product.quantity]}),/*#__PURE__*/_jsx(\"p\",{children:product.description}),/*#__PURE__*/_jsx(\"p\",{children:product.content}),/*#__PURE__*/_jsxs(\"div\",{className:\"amount\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return decrement(product._id);},children:\" - \"}),/*#__PURE__*/_jsx(\"span\",{children:product.quantity}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return increment(product._id);},children:\" + \"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"delete\",onClick:function onClick(){return removeProduct(product._id);},children:\"X\"})]})]},product._id);}),/*#__PURE__*/_jsxs(\"div\",{className:\"total\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"Total: $ \",total]}),/*#__PURE__*/_jsx(PaypalButton,{})]})]});}export default Cart;","map":{"version":3,"names":["React","useContext","useState","useEffect","GlobalState","axios","PaypalButton","Cart","state","userAPI","cart","setCart","token","total","setTotal","getTotal","reduce","prev","item","price","quantity","addToCart","patch","headers","Authorization","increment","id","forEach","_id","decrement","removeProduct","window","confirm","index","splice","tranSuccess","payment","paymentID","address","console","log","post","alert","length","textAlign","fontSize","map","product","images","url","title","description","content"],"sources":["C:/Users/scs/OneDrive/Desktop/9 hours insa_allah/client/src/components/mainpages/cart/Cart.js"],"sourcesContent":["import React, { useContext, useState, useEffect } from \"react\";\r\nimport { GlobalState } from \"../../../GlobaalState\";\r\nimport axios from \"axios\";\r\nimport PaypalButton from \"./PaypalButton\";\r\n\r\nfunction Cart() {\r\n  const state = useContext(GlobalState);\r\n  const [cart, setCart] = state.userAPI.cart;\r\n  const [token] = state.token;\r\n  const [total, setTotal] = useState(0);\r\n\r\n  useEffect(() => {\r\n    const getTotal = () => {\r\n      const total = cart.reduce((prev, item) => {\r\n        return prev + item.price * item.quantity;\r\n      }, 0);\r\n\r\n      setTotal(total);\r\n    };\r\n\r\n    getTotal();\r\n  }, [cart]);\r\n\r\n  const addToCart = async (cart) => {\r\n    await axios.patch(\r\n      \"/user/addcart\",\r\n      { cart },\r\n      {\r\n        headers: { Authorization: token },\r\n      }\r\n    );\r\n  };\r\n\r\n  const increment = (id) => {\r\n    cart.forEach((item) => {\r\n      if (item._id === id) {\r\n        item.quantity += 1;\r\n      }\r\n    });\r\n\r\n    setCart([...cart]);\r\n    addToCart(cart);\r\n  };\r\n\r\n  const decrement = (id) => {\r\n    cart.forEach((item) => {\r\n      if (item._id === id) {\r\n        item.quantity === 1 ? (item.quantity = 1) : (item.quantity -= 1);\r\n      }\r\n    });\r\n\r\n    setCart([...cart]);\r\n    addToCart(cart);\r\n  };\r\n\r\n  const removeProduct = (id) => {\r\n    if (window.confirm(\"Do you want to delete this product?\")) {\r\n      cart.forEach((item, index) => {\r\n        if (item._id === id) {\r\n          cart.splice(index, 1);\r\n        }\r\n      });\r\n\r\n      setCart([...cart]);\r\n      addToCart(cart);\r\n    }\r\n  };\r\n\r\n  const tranSuccess = async (payment) => {\r\n    const { paymentID, address } = payment;\r\n    console.log(payment)\r\n\r\n    await axios.post(\r\n      \"/api/payment\",\r\n      { cart, paymentID, address },\r\n      {\r\n        headers: { Authorization: token },\r\n      }\r\n    );\r\n\r\n    setCart([]);\r\n    addToCart([]);\r\n    alert(\"You have successfully placed an order.\");\r\n  };\r\n\r\n  if (cart.length === 0)\r\n    return <h2 style={{ textAlign: \"center\", fontSize: \"5rem\" }}>Cart Empty</h2>;\r\n\r\n  return (\r\n    <div>\r\n      {cart.map((product) => (\r\n        <div className=\"detail cart\" key={product._id}>\r\n          <img src={product.images.url} alt=\"\" />\r\n\r\n          <div className=\"box-detail\">\r\n            <h2>{product.title}</h2>\r\n\r\n            <h3>$ {product.price * product.quantity}</h3>\r\n            <p>{product.description}</p>\r\n            <p>{product.content}</p>\r\n\r\n            <div className=\"amount\">\r\n              <button onClick={() => decrement(product._id)}> - </button>\r\n              <span>{product.quantity}</span>\r\n              <button onClick={() => increment(product._id)}> + </button>\r\n            </div>\r\n\r\n            <div className=\"delete\" onClick={() => removeProduct(product._id)}>\r\n              X\r\n            </div>\r\n          </div>\r\n        </div>\r\n      ))}\r\n\r\n      <div className=\"total\">\r\n        <h3>Total: $ {total}</h3>\r\n        <PaypalButton  />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Cart;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}