{"ast":null,"code":"import _objectSpread from\"C:/Users/scs/OneDrive/Desktop/9 hours insa_allah/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _toConsumableArray from\"C:/Users/scs/OneDrive/Desktop/9 hours insa_allah/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _regeneratorRuntime from\"C:/Users/scs/OneDrive/Desktop/9 hours insa_allah/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/scs/OneDrive/Desktop/9 hours insa_allah/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/scs/OneDrive/Desktop/9 hours insa_allah/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from'react';import axios from'axios';function UserAPI(token){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isLogged=_useState2[0],setIsLogged=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isAdmin=_useState4[0],setIsAdmin=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),cart=_useState6[0],setCart=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),history=_useState8[0],setHistory=_useState8[1];useEffect(function(){if(token){var getUser=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get('/user/infor',{headers:{Authorization:token}});case 3:res=_context.sent;setIsLogged(true);res.data.role===1?setIsAdmin(true):setIsAdmin(false);setCart(res.data.cart);_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](0);alert(_context.t0.response.data.msg);case 12:case\"end\":return _context.stop();}}},_callee,null,[[0,9]]);}));return function getUser(){return _ref.apply(this,arguments);};}();getUser();}},[token]);var addCart=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(product){var check;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(isLogged){_context2.next=2;break;}return _context2.abrupt(\"return\",alert(\"Please login to continue buying\"));case 2:check=cart.every(function(item){return item._id!==product._id;});if(!check){_context2.next=9;break;}setCart([].concat(_toConsumableArray(cart),[_objectSpread(_objectSpread({},product),{},{quantity:1})]));_context2.next=7;return axios.patch('/user/addcart',{cart:[].concat(_toConsumableArray(cart),[_objectSpread(_objectSpread({},product),{},{quantity:1})])},{headers:{Authorization:token}});case 7:_context2.next=10;break;case 9:alert(\"This product has been added to cart.\");case 10:case\"end\":return _context2.stop();}}},_callee2);}));return function addCart(_x){return _ref2.apply(this,arguments);};}();return{isLogged:[isLogged,setIsLogged],isAdmin:[isAdmin,setIsAdmin],cart:[cart,setCart],addCart:addCart,history:[history,setHistory]};}export default UserAPI;","map":{"version":3,"names":["useState","useEffect","axios","UserAPI","token","isLogged","setIsLogged","isAdmin","setIsAdmin","cart","setCart","history","setHistory","getUser","get","headers","Authorization","res","data","role","alert","response","msg","addCart","product","check","every","item","_id","quantity","patch"],"sources":["C:/Users/scs/OneDrive/Desktop/9 hours insa_allah/client/src/api/UserAPI.js"],"sourcesContent":["import {useState, useEffect} from 'react'\nimport axios from 'axios'\n\nfunction UserAPI(token) {\n    const [isLogged, setIsLogged] = useState(false)\n    const [isAdmin, setIsAdmin] = useState(false)\n    const [cart, setCart] = useState([])\n    const [history, setHistory] = useState([])\n\n    useEffect(() =>{\n        if(token){\n            const getUser = async () =>{\n                try {\n                    const res = await axios.get('/user/infor', {\n                        headers: {Authorization: token}\n                    })\n\n                    setIsLogged(true)\n                    res.data.role === 1 ? setIsAdmin(true) : setIsAdmin(false)\n\n                    setCart(res.data.cart)\n\n                } catch (err) {\n                    alert(err.response.data.msg)\n                }\n            }\n\n            getUser()\n            \n        }\n    },[token])\n\n    \n\n    const addCart = async (product) => {\n        if(!isLogged) return alert(\"Please login to continue buying\")\n\n        const check = cart.every(item =>{\n            return item._id !== product._id\n        })\n\n        if(check){\n            setCart([...cart, {...product, quantity: 1}])\n\n            await axios.patch('/user/addcart', {cart: [...cart, {...product, quantity: 1}]}, {\n                headers: {Authorization: token}\n            })\n\n        }else{\n            alert(\"This product has been added to cart.\")\n        }\n    }\n\n    return {\n        isLogged: [isLogged, setIsLogged],\n        isAdmin: [isAdmin, setIsAdmin],\n        cart: [cart, setCart],\n        addCart: addCart,\n        history: [history, setHistory]\n    }\n}\n\nexport default UserAPI\n "],"mappings":"wtBAAA,OAAQA,QAAQ,CAAEC,SAAS,KAAO,OAAO,CACzC,MAAOC,MAAK,KAAM,OAAO,CAEzB,QAASC,QAAO,CAACC,KAAK,CAAE,CACpB,cAAgCJ,QAAQ,CAAC,KAAK,CAAC,wCAAxCK,QAAQ,eAAEC,WAAW,eAC5B,eAA8BN,QAAQ,CAAC,KAAK,CAAC,yCAAtCO,OAAO,eAAEC,UAAU,eAC1B,eAAwBR,QAAQ,CAAC,EAAE,CAAC,yCAA7BS,IAAI,eAAEC,OAAO,eACpB,eAA8BV,QAAQ,CAAC,EAAE,CAAC,yCAAnCW,OAAO,eAAEC,UAAU,eAE1BX,SAAS,CAAC,UAAK,CACX,GAAGG,KAAK,CAAC,CACL,GAAMS,QAAO,4FAAG,mLAEUX,MAAK,CAACY,GAAG,CAAC,aAAa,CAAE,CACvCC,OAAO,CAAE,CAACC,aAAa,CAAEZ,KAAK,CAClC,CAAC,CAAC,QAFIa,GAAG,eAITX,WAAW,CAAC,IAAI,CAAC,CACjBW,GAAG,CAACC,IAAI,CAACC,IAAI,GAAK,CAAC,CAAGX,UAAU,CAAC,IAAI,CAAC,CAAGA,UAAU,CAAC,KAAK,CAAC,CAE1DE,OAAO,CAACO,GAAG,CAACC,IAAI,CAACT,IAAI,CAAC,gFAGtBW,KAAK,CAAC,YAAIC,QAAQ,CAACH,IAAI,CAACI,GAAG,CAAC,qEAEnC,kBAdKT,QAAO,0CAcZ,CAEDA,OAAO,EAAE,CAEb,CACJ,CAAC,CAAC,CAACT,KAAK,CAAC,CAAC,CAIV,GAAMmB,QAAO,6FAAG,kBAAOC,OAAO,qIACtBnB,QAAQ,2DAASe,KAAK,CAAC,iCAAiC,CAAC,SAEvDK,KAAK,CAAGhB,IAAI,CAACiB,KAAK,CAAC,SAAAC,IAAI,CAAG,CAC5B,MAAOA,KAAI,CAACC,GAAG,GAAKJ,OAAO,CAACI,GAAG,CACnC,CAAC,CAAC,KAECH,KAAK,0BACJf,OAAO,8BAAKD,IAAI,kCAAMe,OAAO,MAAEK,QAAQ,CAAE,CAAC,KAAG,wBAEvC3B,MAAK,CAAC4B,KAAK,CAAC,eAAe,CAAE,CAACrB,IAAI,8BAAMA,IAAI,kCAAMe,OAAO,MAAEK,QAAQ,CAAE,CAAC,IAAE,CAAC,CAAE,CAC7Ed,OAAO,CAAE,CAACC,aAAa,CAAEZ,KAAK,CAClC,CAAC,CAAC,uCAGFgB,KAAK,CAAC,sCAAsC,CAAC,0DAEpD,kBAjBKG,QAAO,6CAiBZ,CAED,MAAO,CACHlB,QAAQ,CAAE,CAACA,QAAQ,CAAEC,WAAW,CAAC,CACjCC,OAAO,CAAE,CAACA,OAAO,CAAEC,UAAU,CAAC,CAC9BC,IAAI,CAAE,CAACA,IAAI,CAAEC,OAAO,CAAC,CACrBa,OAAO,CAAEA,OAAO,CAChBZ,OAAO,CAAE,CAACA,OAAO,CAAEC,UAAU,CACjC,CAAC,CACL,CAEA,cAAeT,QAAO"},"metadata":{},"sourceType":"module"}