{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/scs/OneDrive/Desktop/9 hours insa_allah/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/scs/OneDrive/Desktop/9 hours insa_allah/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/scs/OneDrive/Desktop/9 hours insa_allah/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";// import axios from \"axios\";\n// import { createContext, useState,useEffect } from \"react\";\n// import CategoriesAPI from \"./api/CategoriesAPI\";\n// import ProductsAPI from \"./api/ProductsAPI\";\n// import UserAPI from \"./api/UserAPI\";\n// export const GlobalState = createContext();\n// export const DataProvider = ({ children }) => {\n//     const [token, setToken] = useState(false)\n//     const refreshToken = async() => {\n//         const res =await axios.get(\"/user/refresh_token\");\n//         setToken(res.data.accesstoken)\n//         console.log(res)\n//     }\n//     useEffect(() => {\n//         const firstLogin = localStorage.getItem(\"firstLogin\")\n//         if(firstLogin)refreshToken()\n//     }, [])\n//     const state = {\n//       token: [token, setToken],\n//       productsAPI: ProductsAPI(),\n//       userAPI: UserAPI(token),\n//       categoriesAPI:CategoriesAPI(),\n//     };\n//     return <GlobalState.Provider value={state}>\n//         {children}\n//     </GlobalState.Provider>;\n// };\nimport React,{createContext,useState,useEffect}from\"react\";import ProductsAPI from\"./api/ProductsAPI\";import UserAPI from\"./api/UserAPI\";import CategoriesAPI from\"./api/CategoriesAPI\";import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";export var GlobalState=/*#__PURE__*/createContext();export var DataProvider=function DataProvider(_ref){var children=_ref.children;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),token=_useState2[0],setToken=_useState2[1];useEffect(function(){var firstLogin=localStorage.getItem(\"firstLogin\");if(firstLogin){var refreshToken=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(\"/user/refresh_token\");case 2:res=_context.sent;setToken(res.data.accesstoken);setTimeout(function(){refreshToken();},10*60*1000);case 5:case\"end\":return _context.stop();}}},_callee);}));return function refreshToken(){return _ref2.apply(this,arguments);};}();refreshToken();}},[]);var state={token:[token,setToken],productsAPI:ProductsAPI(),userAPI:UserAPI(token),categoriesAPI:CategoriesAPI()};return/*#__PURE__*/_jsx(GlobalState.Provider,{value:state,children:children});};","map":{"version":3,"names":["React","createContext","useState","useEffect","ProductsAPI","UserAPI","CategoriesAPI","axios","GlobalState","DataProvider","children","token","setToken","firstLogin","localStorage","getItem","refreshToken","get","res","data","accesstoken","setTimeout","state","productsAPI","userAPI","categoriesAPI"],"sources":["C:/Users/scs/OneDrive/Desktop/9 hours insa_allah/client/src/GlobaalState.js"],"sourcesContent":["// import axios from \"axios\";\r\n// import { createContext, useState,useEffect } from \"react\";\r\n// import CategoriesAPI from \"./api/CategoriesAPI\";\r\n// import ProductsAPI from \"./api/ProductsAPI\";\r\n// import UserAPI from \"./api/UserAPI\";\r\n// export const GlobalState = createContext();\r\n// export const DataProvider = ({ children }) => {\r\n//     const [token, setToken] = useState(false)\r\n//     const refreshToken = async() => {\r\n//         const res =await axios.get(\"/user/refresh_token\");\r\n       \r\n//         setToken(res.data.accesstoken)\r\n//         console.log(res)\r\n//     }\r\n//     useEffect(() => {\r\n//         const firstLogin = localStorage.getItem(\"firstLogin\")\r\n//         if(firstLogin)refreshToken()\r\n//     }, [])\r\n    \r\n//     const state = {\r\n//       token: [token, setToken],\r\n//       productsAPI: ProductsAPI(),\r\n//       userAPI: UserAPI(token),\r\n//       categoriesAPI:CategoriesAPI(),\r\n//     };\r\n//     return <GlobalState.Provider value={state}>\r\n//         {children}\r\n//     </GlobalState.Provider>;\r\n// };\r\nimport React, { createContext, useState, useEffect } from \"react\";\r\nimport ProductsAPI from \"./api/ProductsAPI\";\r\nimport UserAPI from \"./api/UserAPI\";\r\nimport CategoriesAPI from \"./api/CategoriesAPI\";\r\n\r\nimport axios from \"axios\";\r\n\r\nexport const GlobalState = createContext();\r\n\r\nexport const DataProvider = ({ children }) => {\r\n  const [token, setToken] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const firstLogin = localStorage.getItem(\"firstLogin\");\r\n    if (firstLogin) {\r\n      const refreshToken = async () => {\r\n        const res = await axios.get(\"/user/refresh_token\");\r\n\r\n        setToken(res.data.accesstoken);\r\n\r\n        setTimeout(() => {\r\n          refreshToken();\r\n        }, 10 * 60 * 1000);\r\n      };\r\n      refreshToken();\r\n    }\r\n  }, []);\r\n\r\n  const state = {\r\n    token: [token, setToken],\r\n    productsAPI: ProductsAPI(),\r\n    userAPI: UserAPI(token),\r\n    categoriesAPI: CategoriesAPI(),\r\n  };\r\n\r\n  return <GlobalState.Provider value={state}>{children}</GlobalState.Provider>;\r\n};"],"mappings":"ubAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAOA,MAAK,EAAIC,aAAa,CAAEC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CACjE,MAAOC,YAAW,KAAM,mBAAmB,CAC3C,MAAOC,QAAO,KAAM,eAAe,CACnC,MAAOC,cAAa,KAAM,qBAAqB,CAE/C,MAAOC,MAAK,KAAM,OAAO,CAAC,2CAE1B,MAAO,IAAMC,YAAW,cAAGP,aAAa,EAAE,CAE1C,MAAO,IAAMQ,aAAY,CAAG,QAAfA,aAAY,MAAqB,IAAfC,SAAQ,MAARA,QAAQ,CACrC,cAA0BR,QAAQ,CAAC,KAAK,CAAC,wCAAlCS,KAAK,eAAEC,QAAQ,eAEtBT,SAAS,CAAC,UAAM,CACd,GAAMU,WAAU,CAAGC,YAAY,CAACC,OAAO,CAAC,YAAY,CAAC,CACrD,GAAIF,UAAU,CAAE,CACd,GAAMG,aAAY,6FAAG,mKACDT,MAAK,CAACU,GAAG,CAAC,qBAAqB,CAAC,QAA5CC,GAAG,eAETN,QAAQ,CAACM,GAAG,CAACC,IAAI,CAACC,WAAW,CAAC,CAE9BC,UAAU,CAAC,UAAM,CACfL,YAAY,EAAE,CAChB,CAAC,CAAE,EAAE,CAAG,EAAE,CAAG,IAAI,CAAC,CAAC,sDACpB,kBARKA,aAAY,2CAQjB,CACDA,YAAY,EAAE,CAChB,CACF,CAAC,CAAE,EAAE,CAAC,CAEN,GAAMM,MAAK,CAAG,CACZX,KAAK,CAAE,CAACA,KAAK,CAAEC,QAAQ,CAAC,CACxBW,WAAW,CAAEnB,WAAW,EAAE,CAC1BoB,OAAO,CAAEnB,OAAO,CAACM,KAAK,CAAC,CACvBc,aAAa,CAAEnB,aAAa,EAC9B,CAAC,CAED,mBAAO,KAAC,WAAW,CAAC,QAAQ,EAAC,KAAK,CAAEgB,KAAM,UAAEZ,QAAQ,EAAwB,CAC9E,CAAC"},"metadata":{},"sourceType":"module"}