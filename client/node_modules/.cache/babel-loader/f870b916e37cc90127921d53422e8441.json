{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/scs/OneDrive/Desktop/9 hours insa_allah/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/scs/OneDrive/Desktop/9 hours insa_allah/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/scs/OneDrive/Desktop/9 hours insa_allah/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useContext,useEffect}from\"react\";import{GlobalState}from\"../../../GlobaalState\";import{Link}from\"react-router-dom\";import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function OrderHistory(){var state=useContext(GlobalState);var _state$userAPI$histor=_slicedToArray(state.userAPI.history,2),history=_state$userAPI$histor[0],setHistory=_state$userAPI$histor[1];var _state$userAPI$isAdmi=_slicedToArray(state.userAPI.isAdmin,1),isAdmin=_state$userAPI$isAdmi[0];var _state$token=_slicedToArray(state.token,1),token=_state$token[0];useEffect(function(){if(token){var getHistory=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res,_res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!isAdmin){_context.next=7;break;}_context.next=3;return axios.get(\"/api/payment\",{headers:{Authorization:token}});case 3:res=_context.sent;setHistory(res.data);_context.next=11;break;case 7:_context.next=9;return axios.get(\"/user/history\",{headers:{Authorization:token}});case 9:_res=_context.sent;setHistory(_res.data);case 11:case\"end\":return _context.stop();}}},_callee);}));return function getHistory(){return _ref.apply(this,arguments);};}();getHistory();}},[token,isAdmin,setHistory]);return/*#__PURE__*/_jsxs(\"div\",{className:\"history-page\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"History\"}),/*#__PURE__*/_jsxs(\"h4\",{children:[\"You have \",history.length,\" ordered\"]}),/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Payment ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Date of Purchased\"}),/*#__PURE__*/_jsx(\"th\",{})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:history.map(function(items){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:items.paymentID}),/*#__PURE__*/_jsx(\"td\",{children:new Date(items.createdAt).toLocaleDateString()}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Link,{to:\"/history/\".concat(items._id),children:\"View\"})})]},items._id);})})]})]});}export default OrderHistory;","map":{"version":3,"names":["React","useContext","useEffect","GlobalState","Link","axios","OrderHistory","state","userAPI","history","setHistory","isAdmin","token","getHistory","get","headers","Authorization","res","data","length","map","items","paymentID","Date","createdAt","toLocaleDateString","_id"],"sources":["C:/Users/scs/OneDrive/Desktop/9 hours insa_allah/client/src/components/mainpages/history/OrderHistory.js"],"sourcesContent":["import React, { useContext, useEffect } from \"react\";\r\nimport { GlobalState } from \"../../../GlobaalState\";\r\nimport { Link } from \"react-router-dom\";\r\nimport axios from \"axios\";\r\n\r\nfunction OrderHistory() {\r\n  const state = useContext(GlobalState);\r\n  const [history, setHistory] = state.userAPI.history;\r\n  const [isAdmin] = state.userAPI.isAdmin;\r\n  const [token] = state.token;\r\n\r\n  useEffect(() => {\r\n    if (token) {\r\n      const getHistory = async () => {\r\n        if (isAdmin) {\r\n          const res = await axios.get(\"/api/payment\", {\r\n            headers: { Authorization: token },\r\n          });\r\n          setHistory(res.data);\r\n        } else {\r\n          const res = await axios.get(\"/user/history\", {\r\n            headers: { Authorization: token },\r\n          });\r\n          setHistory(res.data);\r\n        }\r\n      };\r\n      getHistory();\r\n    }\r\n  }, [token, isAdmin, setHistory]);\r\n\r\n  return (\r\n    <div className=\"history-page\">\r\n      <h2>History</h2>\r\n\r\n      <h4>You have {history.length} ordered</h4>\r\n\r\n      <table>\r\n        <thead>\r\n          <tr>\r\n            <th>Payment ID</th>\r\n            <th>Date of Purchased</th>\r\n            <th></th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {history.map((items) => (\r\n            <tr key={items._id}>\r\n              <td>{items.paymentID}</td>\r\n              <td>{new Date(items.createdAt).toLocaleDateString()}</td>\r\n              <td>\r\n                <Link to={`/history/${items._id}`}>View</Link>\r\n              </td>\r\n            </tr>\r\n          ))}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default OrderHistory;\r\n"],"mappings":"ubAAA,MAAOA,MAAK,EAAIC,UAAU,CAAEC,SAAS,KAAQ,OAAO,CACpD,OAASC,WAAW,KAAQ,uBAAuB,CACnD,OAASC,IAAI,KAAQ,kBAAkB,CACvC,MAAOC,MAAK,KAAM,OAAO,CAAC,wFAE1B,QAASC,aAAY,EAAG,CACtB,GAAMC,MAAK,CAAGN,UAAU,CAACE,WAAW,CAAC,CACrC,yCAA8BI,KAAK,CAACC,OAAO,CAACC,OAAO,IAA5CA,OAAO,0BAAEC,UAAU,0BAC1B,yCAAkBH,KAAK,CAACC,OAAO,CAACG,OAAO,IAAhCA,OAAO,0BACd,gCAAgBJ,KAAK,CAACK,KAAK,IAApBA,KAAK,iBAEZV,SAAS,CAAC,UAAM,CACd,GAAIU,KAAK,CAAE,CACT,GAAMC,WAAU,4FAAG,sJACbF,OAAO,+CACSN,MAAK,CAACS,GAAG,CAAC,cAAc,CAAE,CAC1CC,OAAO,CAAE,CAAEC,aAAa,CAAEJ,KAAM,CAClC,CAAC,CAAC,QAFIK,GAAG,eAGTP,UAAU,CAACO,GAAG,CAACC,IAAI,CAAC,CAAC,oDAEHb,MAAK,CAACS,GAAG,CAAC,eAAe,CAAE,CAC3CC,OAAO,CAAE,CAAEC,aAAa,CAAEJ,KAAM,CAClC,CAAC,CAAC,QAFIK,IAAG,eAGTP,UAAU,CAACO,IAAG,CAACC,IAAI,CAAC,CAAC,uDAExB,kBAZKL,WAAU,0CAYf,CACDA,UAAU,EAAE,CACd,CACF,CAAC,CAAE,CAACD,KAAK,CAAED,OAAO,CAAED,UAAU,CAAC,CAAC,CAEhC,mBACE,aAAK,SAAS,CAAC,cAAc,wBAC3B,+BAAgB,cAEhB,kCAAcD,OAAO,CAACU,MAAM,cAAc,cAE1C,sCACE,oCACE,mCACE,kCAAmB,cACnB,yCAA0B,cAC1B,aAAS,GACN,EACC,cACR,uBACGV,OAAO,CAACW,GAAG,CAAC,SAACC,KAAK,qBACjB,mCACE,oBAAKA,KAAK,CAACC,SAAS,EAAM,cAC1B,oBAAK,GAAIC,KAAI,CAACF,KAAK,CAACG,SAAS,CAAC,CAACC,kBAAkB,EAAE,EAAM,cACzD,iCACE,KAAC,IAAI,EAAC,EAAE,oBAAcJ,KAAK,CAACK,GAAG,CAAG,kBAAY,EAC3C,GALEL,KAAK,CAACK,GAAG,CAMb,EACN,CAAC,EACI,GACF,GACJ,CAEV,CAEA,cAAepB,aAAY"},"metadata":{},"sourceType":"module"}